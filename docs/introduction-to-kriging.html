<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 1 Introduction to Kriging | 數據科學隨筆</title>
  <meta name="description" content="<p>This is a minimal example of using the bookdown package to write a book.
The HTML output format for this example is bookdown::gitbook,
set in the _output.yml file.</p>" />
  <meta name="generator" content="bookdown 0.26 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 1 Introduction to Kriging | 數據科學隨筆" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="<p>This is a minimal example of using the bookdown package to write a book.
The HTML output format for this example is bookdown::gitbook,
set in the _output.yml file.</p>" />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 1 Introduction to Kriging | 數據科學隨筆" />
  
  <meta name="twitter:description" content="<p>This is a minimal example of using the bookdown package to write a book.
The HTML output format for this example is bookdown::gitbook,
set in the _output.yml file.</p>" />
  

<meta name="author" content="DongDong" />


<meta name="date" content="2022-05-08" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="index.html"/>
<link rel="next" href="linear-algebra.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Categorial</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introduction</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#side-story"><i class="fa fa-check"></i>Side Story</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#smarter-than-you-think"><i class="fa fa-check"></i>Smarter than you think</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#真正意義上的變強"><i class="fa fa-check"></i>真正意義上的變強</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="1" data-path="introduction-to-kriging.html"><a href="introduction-to-kriging.html"><i class="fa fa-check"></i><b>1</b> Introduction to Kriging</a>
<ul>
<li class="chapter" data-level="1.1" data-path="introduction-to-kriging.html"><a href="introduction-to-kriging.html#assumption"><i class="fa fa-check"></i><b>1.1</b> Assumption</a>
<ul>
<li class="chapter" data-level="" data-path="introduction-to-kriging.html"><a href="introduction-to-kriging.html#pros-and-cons"><i class="fa fa-check"></i>Pros and cons</a></li>
<li class="chapter" data-level="" data-path="introduction-to-kriging.html"><a href="introduction-to-kriging.html#relation-to-gpr"><i class="fa fa-check"></i>Relation to GPR</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="introduction-to-kriging.html"><a href="introduction-to-kriging.html#blue-best-linear-unbiased-estimator"><i class="fa fa-check"></i><b>1.2</b> BLUE (Best Linear Unbiased Estimator)</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="introduction-to-kriging.html"><a href="introduction-to-kriging.html#普通克里金-ok-oridnary-kriging"><i class="fa fa-check"></i><b>1.2.1</b> 普通克里金 (OK Oridnary Kriging)</a></li>
<li class="chapter" data-level="1.2.2" data-path="introduction-to-kriging.html"><a href="introduction-to-kriging.html#半方差圖-variogram"><i class="fa fa-check"></i><b>1.2.2</b> 半方差圖 (Variogram)</a></li>
<li class="chapter" data-level="1.2.3" data-path="introduction-to-kriging.html"><a href="introduction-to-kriging.html#簡單克里金-sk-simple-kriging"><i class="fa fa-check"></i><b>1.2.3</b> 簡單克里金 (SK Simple Kriging)</a></li>
<li class="chapter" data-level="1.2.4" data-path="introduction-to-kriging.html"><a href="introduction-to-kriging.html#泛克里金-uk-universal-kriging"><i class="fa fa-check"></i><b>1.2.4</b> 泛克里金 (UK Universal kriging)</a></li>
<li class="chapter" data-level="1.2.5" data-path="introduction-to-kriging.html"><a href="introduction-to-kriging.html#協同克里金-ck-co-kriging"><i class="fa fa-check"></i><b>1.2.5</b> 協同克里金 (CK Co-Kriging)</a></li>
<li class="chapter" data-level="1.2.6" data-path="introduction-to-kriging.html"><a href="introduction-to-kriging.html#析取克里金-dk-disjunctive-kriging"><i class="fa fa-check"></i><b>1.2.6</b> 析取克里金 (DK Disjunctive Kriging)</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="introduction-to-kriging.html"><a href="introduction-to-kriging.html#r-語言實作"><i class="fa fa-check"></i><b>1.3</b> R 語言實作</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="linear-algebra.html"><a href="linear-algebra.html"><i class="fa fa-check"></i><b>2</b> Linear Algebra</a>
<ul>
<li class="chapter" data-level="2.1" data-path="linear-algebra.html"><a href="linear-algebra.html#vector-space-向量空間"><i class="fa fa-check"></i><b>2.1</b> Vector Space (向量空間)</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="linear-algebra.html"><a href="linear-algebra.html#subspacce-子空間"><i class="fa fa-check"></i><b>2.1.1</b> Subspacce (子空間)</a></li>
<li class="chapter" data-level="2.1.2" data-path="linear-algebra.html"><a href="linear-algebra.html#sum-space-和空間"><i class="fa fa-check"></i><b>2.1.2</b> Sum space (和空間)</a></li>
<li class="chapter" data-level="2.1.3" data-path="linear-algebra.html"><a href="linear-algebra.html#four-basis-spaces-四大基本子空間"><i class="fa fa-check"></i><b>2.1.3</b> Four Basis Spaces (四大基本子空間)</a></li>
<li class="chapter" data-level="2.1.4" data-path="linear-algebra.html"><a href="linear-algebra.html#solve-linear-system-求解線性系統"><i class="fa fa-check"></i><b>2.1.4</b> Solve Linear System (求解線性系統)</a></li>
<li class="chapter" data-level="2.1.5" data-path="linear-algebra.html"><a href="linear-algebra.html#線性系統求解演算法"><i class="fa fa-check"></i><b>2.1.5</b> 線性系統求解演算法</a></li>
<li class="chapter" data-level="2.1.6" data-path="linear-algebra.html"><a href="linear-algebra.html#spanning-set-and-generating-set-生成集與獨立集"><i class="fa fa-check"></i><b>2.1.6</b> Spanning Set and Generating Set (生成集與獨立集)</a></li>
<li class="chapter" data-level="2.1.7" data-path="linear-algebra.html"><a href="linear-algebra.html#和空間的生成集"><i class="fa fa-check"></i><b>2.1.7</b> 和空間的生成集</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="linear-algebra.html"><a href="linear-algebra.html#linear-independent-and-linear-dependent-線性獨立與線性相依"><i class="fa fa-check"></i><b>2.2</b> Linear independent and Linear dependent (線性獨立與線性相依)</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="linear-algebra.html"><a href="linear-algebra.html#線性獨立判別法"><i class="fa fa-check"></i><b>2.2.1</b> 線性獨立判別法</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="linear-algebra.html"><a href="linear-algebra.html#basis-and-space-property-基底與空間特性"><i class="fa fa-check"></i><b>2.3</b> Basis and Space Property (基底與空間特性)</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="linear-algebra.html"><a href="linear-algebra.html#四大子空間的基底"><i class="fa fa-check"></i><b>2.3.1</b> 四大子空間的基底</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="linear-algebra.html"><a href="linear-algebra.html#linear-transformation-線性映射"><i class="fa fa-check"></i><b>2.4</b> Linear transformation (線性映射)</a></li>
<li class="chapter" data-level="2.5" data-path="linear-algebra.html"><a href="linear-algebra.html#rank-of-a-matrix-矩陣的秩"><i class="fa fa-check"></i><b>2.5</b> Rank of a Matrix (矩陣的秩)</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="linear-algebra.html"><a href="linear-algebra.html#sylvester-theorem-秩-零度定理"><i class="fa fa-check"></i><b>2.5.1</b> Sylvester Theorem (秩 零度定理)</a></li>
<li class="chapter" data-level="2.5.2" data-path="linear-algebra.html"><a href="linear-algebra.html#property-of-the-rank-秩的特性"><i class="fa fa-check"></i><b>2.5.2</b> Property of the Rank (秩的特性)</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="linear-algebra.html"><a href="linear-algebra.html#direct-sum-and-projection-直和與投影"><i class="fa fa-check"></i><b>2.6</b> Direct Sum and Projection (直和與投影)</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="linear-algebra.html"><a href="linear-algebra.html#projection-matrix-投影矩陣"><i class="fa fa-check"></i><b>2.6.1</b> Projection Matrix (投影矩陣)</a></li>
<li class="chapter" data-level="2.6.2" data-path="linear-algebra.html"><a href="linear-algebra.html#orthogonal-projection-正交投影"><i class="fa fa-check"></i><b>2.6.2</b> Orthogonal Projection (正交投影)</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="linear-algebra.html"><a href="linear-algebra.html#change-basis-and-coordinates-matrix-基底變換與基底變換矩陣"><i class="fa fa-check"></i><b>2.7</b> Change Basis and Coordinates Matrix (基底變換與基底變換矩陣)</a></li>
<li class="chapter" data-level="2.8" data-path="linear-algebra.html"><a href="linear-algebra.html#線性變換矩陣表示法"><i class="fa fa-check"></i><b>2.8</b> 線性變換矩陣表示法</a>
<ul>
<li class="chapter" data-level="2.8.1" data-path="linear-algebra.html"><a href="linear-algebra.html#similarity-of-the-square-matrix-方陣的相似"><i class="fa fa-check"></i><b>2.8.1</b> Similarity of the Square Matrix (方陣的相似)</a></li>
</ul></li>
<li class="chapter" data-level="2.9" data-path="linear-algebra.html"><a href="linear-algebra.html#eigenvalue-and-eigenvetor-特徵值與特徵向量"><i class="fa fa-check"></i><b>2.9</b> Eigenvalue and Eigenvetor (特徵值與特徵向量)</a>
<ul>
<li class="chapter" data-level="2.9.1" data-path="linear-algebra.html"><a href="linear-algebra.html#characteristic-polynomial-特徵多項式"><i class="fa fa-check"></i><b>2.9.1</b> characteristic polynomial (特徵多項式)</a></li>
<li class="chapter" data-level="2.9.2" data-path="linear-algebra.html"><a href="linear-algebra.html#eigenspace-and-multiplicity-特徵空間和重數"><i class="fa fa-check"></i><b>2.9.2</b> Eigenspace and multiplicity (特徵空間和重數)</a></li>
</ul></li>
<li class="chapter" data-level="2.10" data-path="linear-algebra.html"><a href="linear-algebra.html#diagonalizable-可對角化"><i class="fa fa-check"></i><b>2.10</b> Diagonalizable (可對角化)</a></li>
<li class="chapter" data-level="2.11" data-path="linear-algebra.html"><a href="linear-algebra.html#eigen-value-decomposition-特徵值分解"><i class="fa fa-check"></i><b>2.11</b> Eigen Value Decomposition (特徵值分解)</a>
<ul>
<li class="chapter" data-level="2.11.1" data-path="linear-algebra.html"><a href="linear-algebra.html#simulltaneously-diagonalizable-同步對角化"><i class="fa fa-check"></i><b>2.11.1</b> Simulltaneously diagonalizable (同步對角化)</a></li>
<li class="chapter" data-level="2.11.2" data-path="linear-algebra.html"><a href="linear-algebra.html#diagonalization-and-function-limit-對角化與函數極限"><i class="fa fa-check"></i><b>2.11.2</b> Diagonalization and function limit (對角化與函數極限)</a></li>
<li class="chapter" data-level="2.11.3" data-path="linear-algebra.html"><a href="linear-algebra.html#simulltaneously-diagonalizable-同步對角化-1"><i class="fa fa-check"></i><b>2.11.3</b> Simulltaneously diagonalizable (同步對角化)</a></li>
<li class="chapter" data-level="2.11.4" data-path="linear-algebra.html"><a href="linear-algebra.html#diagonalization-and-function-limit-對角化與函數極限-1"><i class="fa fa-check"></i><b>2.11.4</b> Diagonalization and function limit (對角化與函數極限)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="基礎微積分.html"><a href="基礎微積分.html"><i class="fa fa-check"></i><b>3</b> 基礎微積分</a>
<ul>
<li class="chapter" data-level="3.1" data-path="基礎微積分.html"><a href="基礎微積分.html#數列的極限"><i class="fa fa-check"></i><b>3.1</b> 數列的極限</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="基礎微積分.html"><a href="基礎微積分.html#夾擠定理"><i class="fa fa-check"></i><b>3.1.1</b> 夾擠定理</a></li>
<li class="chapter" data-level="3.1.2" data-path="基礎微積分.html"><a href="基礎微積分.html#比較定理"><i class="fa fa-check"></i><b>3.1.2</b> 比較定理</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="基礎微積分.html"><a href="基礎微積分.html#級數"><i class="fa fa-check"></i><b>3.2</b> 級數</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="基礎微積分.html"><a href="基礎微積分.html#數列收斂審歛法"><i class="fa fa-check"></i><b>3.2.1</b> 數列收斂審歛法</a></li>
<li class="chapter" data-level="3.2.2" data-path="基礎微積分.html"><a href="基礎微積分.html#特殊級數"><i class="fa fa-check"></i><b>3.2.2</b> 特殊級數</a></li>
<li class="chapter" data-level="3.2.3" data-path="基礎微積分.html"><a href="基礎微積分.html#交錯級數"><i class="fa fa-check"></i><b>3.2.3</b> 交錯級數</a></li>
<li class="chapter" data-level="3.2.4" data-path="基礎微積分.html"><a href="基礎微積分.html#冪級數"><i class="fa fa-check"></i><b>3.2.4</b> 冪級數</a></li>
<li class="chapter" data-level="3.2.5" data-path="基礎微積分.html"><a href="基礎微積分.html#收斂半徑"><i class="fa fa-check"></i><b>3.2.5</b> 收斂半徑</a></li>
<li class="chapter" data-level="3.2.6" data-path="基礎微積分.html"><a href="基礎微積分.html#泰勒展開式定理"><i class="fa fa-check"></i><b>3.2.6</b> 泰勒展開式定理</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="基礎微積分.html"><a href="基礎微積分.html#純量場"><i class="fa fa-check"></i><b>3.3</b> 純量場</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="基礎微積分.html"><a href="基礎微積分.html#方向導數"><i class="fa fa-check"></i><b>3.3.1</b> 方向導數</a></li>
<li class="chapter" data-level="3.3.2" data-path="基礎微積分.html"><a href="基礎微積分.html#梯度"><i class="fa fa-check"></i><b>3.3.2</b> 梯度</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="基礎微積分.html"><a href="基礎微積分.html#向量場"><i class="fa fa-check"></i><b>3.4</b> 向量場</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="基礎微積分.html"><a href="基礎微積分.html#散度"><i class="fa fa-check"></i><b>3.4.1</b> 散度</a></li>
<li class="chapter" data-level="3.4.2" data-path="基礎微積分.html"><a href="基礎微積分.html#旋度"><i class="fa fa-check"></i><b>3.4.2</b> 旋度</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="基礎微積分.html"><a href="基礎微積分.html#線積分"><i class="fa fa-check"></i><b>3.5</b> 線積分</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="基礎微積分.html"><a href="基礎微積分.html#第一類線積分"><i class="fa fa-check"></i><b>3.5.1</b> 第一類線積分</a></li>
<li class="chapter" data-level="3.5.2" data-path="基礎微積分.html"><a href="基礎微積分.html#第二類線積分"><i class="fa fa-check"></i><b>3.5.2</b> 第二類線積分</a></li>
<li class="chapter" data-level="3.5.3" data-path="基礎微積分.html"><a href="基礎微積分.html#特殊曲線之擺縣"><i class="fa fa-check"></i><b>3.5.3</b> 特殊曲線之擺縣</a></li>
<li class="chapter" data-level="3.5.4" data-path="基礎微積分.html"><a href="基礎微積分.html#與路徑無關的線積分"><i class="fa fa-check"></i><b>3.5.4</b> 與路徑無關的線積分</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="基礎微積分.html"><a href="基礎微積分.html#格林定理"><i class="fa fa-check"></i><b>3.6</b> 格林定理</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">數據科學隨筆</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="introduction-to-kriging" class="section level1 hasAnchor" number="1">
<h1><span class="header-section-number">Chapter 1</span> Introduction to Kriging<a href="introduction-to-kriging.html#introduction-to-kriging" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>克里金法(Kriging)是一種用於空間資料的插值方法，通常視為高斯過程回歸或者 BLUP。</p>
<div id="assumption" class="section level2 hasAnchor" number="1.1">
<h2><span class="header-section-number">1.1</span> Assumption<a href="introduction-to-kriging.html#assumption" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>固有平穩過程 (intrinsically stationary process)</p>
<ul>
<li>數學期望與地理位置無關，即觀察任一小區域他的屬性應當相同 (constant mean or variance)</li>
<li>半方差函數只與距離有關，即觀察任一小區域他的 Variogram 應當相同 (constant variogram)</li>
</ul>
<div class="info">
<p>若未滿足假設(可由 Voronoi 圖檢驗)，可以對資料做轉換 (log transformation of squared)</p>
</div>
<div id="pros-and-cons" class="section level3 unnumbered hasAnchor">
<h3>Pros and cons<a href="introduction-to-kriging.html#pros-and-cons" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>Pros : kriging model 告訴我們感興趣的空間特徵均值，且是最佳無偏 (BLUP)，並且可以估計誤差範圍</li>
<li>Cons : 每當你要重新估計其他區域的資料，你的線性系統要被完全更新</li>
</ul>
</div>
<div id="relation-to-gpr" class="section level3 unnumbered hasAnchor">
<h3>Relation to GPR<a href="introduction-to-kriging.html#relation-to-gpr" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>GPR : 隨機場為高斯過程</li>
<li>Kriging : 隨機場為固有平穩過程</li>
</ul>
<div class="info">
<p>若協方差函數相同，則普通克里金與簡單克里金法與GPR利用正態分配的最大似然估計輸出相同</p>
</div>
</div>
</div>
<div id="blue-best-linear-unbiased-estimator" class="section level2 hasAnchor" number="1.2">
<h2><span class="header-section-number">1.2</span> BLUE (Best Linear Unbiased Estimator)<a href="introduction-to-kriging.html#blue-best-linear-unbiased-estimator" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>通常我們稱克里金法為最佳無偏線性預測(BLUP) :<br />
* <strong>Best :</strong> 最小變方 (最小方差)
* <strong>Linear :</strong> 估計值為觀測值的線性組合
* <strong>Unbiased :</strong> 估計值的期望值等於真值</p>
<div id="普通克里金-ok-oridnary-kriging" class="section level3 hasAnchor" number="1.2.1">
<h3><span class="header-section-number">1.2.1</span> 普通克里金 (OK Oridnary Kriging)<a href="introduction-to-kriging.html#普通克里金-ok-oridnary-kriging" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>我們相信空間資料與地理位置具有相關性，對於未知的某個空間資訊<span class="math inline">\(Y_0\)</span>，我們透過觀測其附近 <span class="math inline">\(n\)</span> 個位置 <span class="math inline">\(s_1,\cdots,s_n\)</span> 的 <span class="math inline">\(n\)</span> 個空間資訊 <span class="math inline">\(Y\)</span> 來線性組合估計 <span class="math inline">\(Y_0\)</span>，及以下表述 :
<span class="math display">\[
\hat Y(s_0) = \sum_{i=1}^n\lambda_iY(s_i) \tag 1
\]</span></p>
<p>現在我們只要找出權重係數 <span class="math inline">\(\lambda_i\)</span> 就能解決問題了!，為了滿足無偏的性質，<strong>普通克里金(Oridnary Kriging)</strong> 假設空間資訊在每一個地理位置都有相同的相同期望值 (constant unknown mean)，即<strong>數學期望值與空間位置無關</strong></p>
<p><span class="math display">\[
Y(\mathbf{s}) = \mu + \delta(\mathbf{s})\tag 2
\]</span></p>
<p>其中 <span class="math inline">\(E(Y) = \mu\)</span> 且 <span class="math inline">\(\delta\)</span> (平均為0的固有平穩過程) 為地理位置 <span class="math inline">\(\mathbf{s}\)</span>，<span class="math inline">\(Y\)</span> 與 <span class="math inline">\(\hat Y\)</span> 的誤差</p>
<p><span class="math display">\[
E(\hat Y(s_0)) = \mu = \mu\sum\lambda_i \iff \sum \lambda_i = 1 \tag 3
\]</span></p>
<p>為了滿足在限制條件 <span class="math inline">\((3)\)</span> 下最佳化</p>
<p><span class="math display">\[
\arg\min_\lambda E(||\hat Y(s_0) - Y(s_0)||^2) \iff \arg\min_\lambda \frac{1}{2}E(||\sum_{i=1}^n\lambda_iY(s_i) -Y(s_0)||^2) \\
\mbox{subject to } \sum_{i=1}^n\lambda_i = 1 \tag 4
\]</span></p>
<p>利用拉格朗日乘數 <span class="math inline">\(L(\lambda_1,\cdots,\lambda_n,\phi)\)</span> 可得，詳見 <a href="http://www1.mate.polimi.it/~bonavent/Homepage_Luca_file/lezkrig005.pdf">克里金法原理與推導</a></p>
<p><span class="math display">\[
\begin{bmatrix}
r_{11}&amp;r_{12}&amp;\cdots&amp;r_{1n}&amp;1\\ r_{21}&amp;r_{22}&amp;\cdots&amp;r_{2n}&amp;1\\
\cdots&amp;\cdots&amp;\cdots&amp;\cdots&amp;\cdots\\
r_{n1}&amp;r_{n2}&amp;\cdots&amp;r_{nn}&amp;1\\1&amp;1&amp;\cdots&amp;1&amp;0\end{bmatrix}
\begin{bmatrix} \lambda_1\\ \lambda_2\\\cdots\\\lambda_n\\-\phi\end{bmatrix}=\begin{bmatrix} r_{1o}\\ r_{2o}\\\cdots\\r_{no}\\1\end{bmatrix} \tag 5
\]</span></p>
<p>其中 <span class="math inline">\(r_{ij}\)</span> 為半方差函數，<span class="math inline">\(\phi\)</span> 為拉格朗日的限制參數，做完逆矩陣即可得權重係數</p>
<p><span class="math display">\[
\begin{bmatrix} \lambda_1\\ \lambda_2\\\cdots\\\lambda_n\\-\phi\end{bmatrix}=
\begin{bmatrix}
r_{11}&amp;r_{12}&amp;\cdots&amp;r_{1n}&amp;1\\ r_{21}&amp;r_{22}&amp;\cdots&amp;r_{2n}&amp;1\\
\cdots&amp;\cdots&amp;\cdots&amp;\cdots&amp;\cdots\\
r_{n1}&amp;r_{n2}&amp;\cdots&amp;r_{nn}&amp;1\\1&amp;1&amp;\cdots&amp;1&amp;0\end{bmatrix}^{-1}
\begin{bmatrix} r_{1o}\\ r_{2o}\\\cdots\\r_{no}\\1\end{bmatrix} \tag 6
\]</span></p>
<p>我們計做 <span class="math inline">\(\lambda_O = \Gamma_O^{-1}\gamma_O\)</span>，帶回原式我們可以估得誤差的方差為 <span class="math inline">\(\sigma^2_O =\lambda_O^\top\gamma_O= \gamma_O^\top \Gamma_O^{-1}\gamma_O\)</span></p>
</div>
<div id="半方差圖-variogram" class="section level3 hasAnchor" number="1.2.2">
<h3><span class="header-section-number">1.2.2</span> 半方差圖 (Variogram)<a href="introduction-to-kriging.html#半方差圖-variogram" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>半方差的定義為 <span class="math inline">\(r_{ij} = \frac{1}{2}E[(Y(s_i) - Y(s_j))^2]\)</span>，根據我們的假設，我們希望地理位置鄰近的地方具有相似的空間資訊，即 <span class="math inline">\(\mbox{Distance}\rightarrow 0 \implies r_{ij} \rightarrow 0\)</span></p>
<p><img src="https://i.imgur.com/PWIf1LT.png" /></p>
<p>半方差圖其中幾個重要的術語</p>
<ul>
<li><strong>Data :</strong> 即 <span class="math inline">\(\frac{1}{2}(Y(s_i) - Y(s_j))^2\)</span>，為上圖中紅色標記點</li>
<li><strong>Variogram model :</strong> 即是 Data 的擬合曲線，常用“線性”、“高斯”、“球面”、“指數”等逼近</li>
<li><strong>Nugget :</strong> 用 <span class="math inline">\(C_o\)</span> 表示，為距離最近兩點的半方差值
<ul>
<li>越大的 <span class="math inline">\(C_o\)</span> 表示空間測量誤差越大</li>
</ul></li>
<li><strong>Sill :</strong> 用 <span class="math inline">\(C_o + C\)</span> 表示，當半方差函數達到一個穩定態時，該半方差值稱為 Sill</li>
<li><strong>Range :</strong> 用 <span class="math inline">\(A_o\)</span> 表示，達到 Sill 的距離，表示空間相關性的作用範圍
<ul>
<li>超過 <span class="math inline">\(A_o\)</span> 我們稱空間相關性不存在，即不能使用內插法</li>
</ul></li>
</ul>
</div>
<div id="簡單克里金-sk-simple-kriging" class="section level3 hasAnchor" number="1.2.3">
<h3><span class="header-section-number">1.2.3</span> 簡單克里金 (SK Simple Kriging)<a href="introduction-to-kriging.html#簡單克里金-sk-simple-kriging" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>不同於普通克里金法，簡單克里金假設未知點的偏差是由已知點的偏差線性組合(with known mean)
<span class="math display">\[
\hat Y(s_0) - \mu = \sum_{i=1}^n\lambda_i(Y(s_i) - \mu)
\]</span>
神奇的是，這個條件會自動滿足無偏性
<span class="math display">\[
E(\hat Y_0) = E(\mu + \sum_{i=1}^n\lambda_i(Y(s_i) - \mu)) = \mu
\]</span>
所以它不需要普通克里金法的限制 <span class="math inline">\((3)\)</span></p>
</div>
<div id="泛克里金-uk-universal-kriging" class="section level3 hasAnchor" number="1.2.4">
<h3><span class="header-section-number">1.2.4</span> 泛克里金 (UK Universal kriging)<a href="introduction-to-kriging.html#泛克里金-uk-universal-kriging" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>泛克里金法假設隨機場 <span class="math inline">\(Y\)</span> 是由隨機場的漂移與固有平穩過程生成出來的</p>
<p><span class="math display">\[
Y(\mathbf{s}) = \sum_{i=1}^p\beta_if_i(\mathbf{s}) + \delta(\mathbf{s})
\]</span></p>
<p>注意到如果取 <span class="math inline">\(f_i = 1,p=1\)</span> 則與普通克里金一樣，為了簡便說明，給出以下符號</p>
<p><span class="math display">\[
\mathbf{X} = \begin{bmatrix}f_1(s_1)&amp;\cdots&amp;f_p(s_1)\\f_1(s_2)&amp;\cdots&amp;f_p(s_2)\\\vdots&amp;\cdots&amp;\vdots\\f_1(s_n)&amp;\cdots&amp;f_p(s_n)\end{bmatrix},\mathbf{\beta} = \begin{bmatrix}\beta_1\\\vdots\\\beta_p\end{bmatrix} \\
\mathbf{\delta(s)} = \begin{bmatrix}\delta(s_1)\\\vdots\\\delta(s_n)\end{bmatrix}, \mathbf{Y} = \begin{bmatrix}Y(s_1)\\\vdots\\Y(s_n)\end{bmatrix}
\]</span></p>
<p>則有 <span class="math inline">\(\bf Y = X\beta + \delta\)</span>，同樣地，為了滿足無偏性，我們有以下限制條件
<span class="math display">\[
E(Y) = \sum_{i=1}^p\beta_if_i(\mathbf{s}) \\
E(\hat Y(s_0)) = E(\sum_{i=1}^n\lambda_iY(s_i)) = \sum_{i=1}^n\lambda_i\sum_{j=1}^p\beta_jf_j(s_i) = \sum_{i=1}^p\beta_if_i(\mathbf{s_0}) \\
f_j(\mathbf{s}) = \sum_{i=1}^n\lambda_if_j(s_i) \mbox{ for } j = 1,\cdots,p \\
\sum_{i=1}^n\lambda_i = 1
\]</span>
再根據拉格朗日乘數求解方程，詳見 <a href="http://www1.mate.polimi.it/~bonavent/Homepage_Luca_file/lezkrig005.pdf">克里金法原理與推導</a>
<span class="math display">\[
L(\lambda_1,\cdots,\lambda_n,m_1,\cdots,m_p) = E[||\hat Y(s_0) - Y(s_0)||^2] - 2m_0(\sum_{i=1}^n\lambda_i-1) - 2\sum_{j=1}^pm_j(\sum_{i=1}^n\lambda_if_j(s_i) - f_j(s_0))
\]</span>
即有
<span class="math display">\[
\begin{bmatrix}
\lambda_1 \\
\vdots \\
\lambda_n \\
m_0 \\
m_1 \\
\vdots  \\
m_p
\end{bmatrix} = \begin{bmatrix}
r_{11}  &amp; \cdots &amp; r_{1n} &amp;1&amp; f_1(s_1) &amp; \cdots &amp; f_1(x_n)\\
 \vdots &amp; \ddots &amp; \vdots  &amp;\vdots&amp; \vdots &amp; \cdots &amp; \vdots\\
r_{n1}  &amp; \cdots &amp; r_{nn} &amp;1&amp; f_p(s_1) &amp; \cdots &amp; f_p(s_n)\\
1&amp;\cdots&amp;1&amp;0&amp;0&amp;\cdots&amp;0 \\
f_1(s_1)  &amp; \cdots &amp; f_1(s_n) &amp;0&amp; 0 &amp; \cdots &amp; 0\\
 \vdots &amp; \ddots &amp; \vdots &amp;\vdots&amp; \vdots &amp; \ddots &amp; \vdots\\
 f_p(s_1) &amp; \cdots &amp; f_p(s_n) &amp; 0 &amp; 0 &amp; \cdots &amp;0
\end{bmatrix}^{-1}\begin{bmatrix}
r_{10} \\
\vdots \\
r_{n0} \\
1 \\
f_1(s_0) \\
\vdots \\
f_p(s_0)
\end{bmatrix}
\]</span>
我們計做 <span class="math inline">\(\lambda_U = \Gamma_U^{-1}\gamma_U\)</span>，帶回原式我們可以估得誤差的方差為 <span class="math inline">\(\sigma^2_U =\lambda_U^\top\gamma_U= \gamma_U^\top \Gamma_U^{-1}\gamma_U\)</span></p>
<p>更進一步，如果 <span class="math inline">\(Y\)</span> 的協方差矩陣 <span class="math inline">\(\Sigma\)</span> 已知，則根據廣義最小平方法，將空間資訊 <span class="math inline">\(Y\)</span> 投影到主成分空間使得誤差的斜方差矩陣沒有外部協方差，則有
<span class="math display">\[
\hat\beta_{gls} = (X^\top\Sigma^{-1} X)^{-1}X^\top\Sigma^{-1} Y
\]</span></p>
</div>
<div id="協同克里金-ck-co-kriging" class="section level3 hasAnchor" number="1.2.5">
<h3><span class="header-section-number">1.2.5</span> 協同克里金 (CK Co-Kriging)<a href="introduction-to-kriging.html#協同克里金-ck-co-kriging" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>協同克里金是克里金法在多變量分析的衍生，協同克里金允許多個空間資訊 <span class="math inline">\(Y_1,\cdots,Y_K\)</span> 分別在地理位置 <span class="math inline">\(\{s_1,\cdots,s_{n_k}\}, k=1,\cdots,K\)</span> 被觀測到，則</p>
<p><span class="math display">\[
\hat Y(s_0) = \sum_{k=1}^K\sum_{i=1}^{n_k}\lambda_{k_i}Y_k(s_i)
\]</span></p>
</div>
<div id="析取克里金-dk-disjunctive-kriging" class="section level3 hasAnchor" number="1.2.6">
<h3><span class="header-section-number">1.2.6</span> 析取克里金 (DK Disjunctive Kriging)<a href="introduction-to-kriging.html#析取克里金-dk-disjunctive-kriging" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>析取克里金是隨機場的非線性估計，注意，在此之前都是線性估計!!</p>
<p><span class="math display">\[
\hat Y(s_0) = \sum_{i=1}^nf_i(Y(s_i))
\]</span></p>
<p>如果 <span class="math inline">\(f_i\)</span> 為指示函數，則析取克里金又稱為指示克里金 (IK Indicator Kriging)</p>
</div>
</div>
<div id="r-語言實作" class="section level2 hasAnchor" number="1.3">
<h2><span class="header-section-number">1.3</span> R 語言實作<a href="introduction-to-kriging.html#r-語言實作" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ol style="list-style-type: decimal">
<li>選定資料集與載入套件</li>
</ol>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="introduction-to-kriging.html#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gstat) <span class="co"># for kriging</span></span>
<span id="cb1-2"><a href="introduction-to-kriging.html#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sp) <span class="co"># for meuse dataset</span></span>
<span id="cb1-3"><a href="introduction-to-kriging.html#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(FRK) <span class="co"># for gird and fixed rank kriging </span></span>
<span id="cb1-4"><a href="introduction-to-kriging.html#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse) <span class="co"># for data flow</span></span>
<span id="cb1-5"><a href="introduction-to-kriging.html#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra) <span class="co"># for combine plot</span></span>
<span id="cb1-6"><a href="introduction-to-kriging.html#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(meuse)</span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li>將資料轉成 SP 格式</li>
</ol>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="introduction-to-kriging.html#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coordinates</span>(meuse) <span class="ot">=</span> <span class="er">~</span> x <span class="sc">+</span> y</span></code></pre></div>
<ol start="3" style="list-style-type: decimal">
<li>建立要預測地點的網格</li>
</ol>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="introduction-to-kriging.html#cb3-1" aria-hidden="true" tabindex="-1"></a>GridBAUs <span class="ot">&lt;-</span> <span class="fu">auto_BAUs</span>(<span class="at">manifold =</span> <span class="fu">plane</span>(), <span class="co"># 2D plane</span></span>
<span id="cb3-2"><a href="introduction-to-kriging.html#cb3-2" aria-hidden="true" tabindex="-1"></a>                       <span class="at">cellsize =</span> <span class="fu">c</span>(<span class="dv">100</span>,<span class="dv">100</span>), <span class="co"># BAU cellsize</span></span>
<span id="cb3-3"><a href="introduction-to-kriging.html#cb3-3" aria-hidden="true" tabindex="-1"></a>                       <span class="at">type =</span> <span class="st">&quot;grid&quot;</span>, <span class="co"># grid (not hex)</span></span>
<span id="cb3-4"><a href="introduction-to-kriging.html#cb3-4" aria-hidden="true" tabindex="-1"></a>                       <span class="at">data =</span> meuse, <span class="co"># data around which to create BAUs</span></span>
<span id="cb3-5"><a href="introduction-to-kriging.html#cb3-5" aria-hidden="true" tabindex="-1"></a>                       <span class="at">convex=</span><span class="sc">-</span><span class="fl">0.05</span>, <span class="co"># border buffer factor</span></span>
<span id="cb3-6"><a href="introduction-to-kriging.html#cb3-6" aria-hidden="true" tabindex="-1"></a>                       <span class="at">nonconvex_hull=</span><span class="cn">FALSE</span>) <span class="co"># convex hull</span></span></code></pre></div>
<div id="反距離權重插值法" class="section level4 hasAnchor" number="1.3.0.1">
<h4><span class="header-section-number">1.3.0.1</span> 反距離權重插值法<a href="introduction-to-kriging.html#反距離權重插值法" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="introduction-to-kriging.html#cb4-1" aria-hidden="true" tabindex="-1"></a>idw2 <span class="ot">&lt;-</span> <span class="fu">idw</span>(<span class="at">formula =</span> <span class="fu">log</span>(zinc) <span class="sc">~</span> <span class="dv">1</span>, <span class="co"># formula</span></span>
<span id="cb4-2"><a href="introduction-to-kriging.html#cb4-2" aria-hidden="true" tabindex="-1"></a>         <span class="at">locations =</span> meuse, <span class="co"># data with measurements</span></span>
<span id="cb4-3"><a href="introduction-to-kriging.html#cb4-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">newdata =</span> GridBAUs, <span class="co"># where to be interpolated</span></span>
<span id="cb4-4"><a href="introduction-to-kriging.html#cb4-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">nmin =</span> <span class="dv">0</span>, <span class="co"># the least numbers of data to be interpolated,</span></span>
<span id="cb4-5"><a href="introduction-to-kriging.html#cb4-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">nmax =</span> <span class="cn">Inf</span>, <span class="co"># the largest numbers of data to be interpolated,</span></span>
<span id="cb4-6"><a href="introduction-to-kriging.html#cb4-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">maxdist =</span> <span class="cn">Inf</span>, <span class="co"># the maximum distance of datat to be interpolated</span></span>
<span id="cb4-7"><a href="introduction-to-kriging.html#cb4-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">idp =</span> <span class="dv">2</span>, <span class="co"># the distance attenuation parameter</span></span>
<span id="cb4-8"><a href="introduction-to-kriging.html#cb4-8" aria-hidden="true" tabindex="-1"></a>         ) </span></code></pre></div>
<pre><code>## [inverse distance weighted interpolation]</code></pre>
<ol start="4" style="list-style-type: decimal">
<li>建立半方差模型</li>
</ol>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="introduction-to-kriging.html#cb6-1" aria-hidden="true" tabindex="-1"></a>lzn.vgm <span class="ot">&lt;-</span> <span class="fu">variogram</span>(<span class="fu">log</span>(zinc)<span class="sc">~</span><span class="dv">1</span>, meuse) <span class="co"># calculates sample variogram values</span></span>
<span id="cb6-2"><a href="introduction-to-kriging.html#cb6-2" aria-hidden="true" tabindex="-1"></a>lzn.model <span class="ot">&lt;-</span> <span class="fu">vgm</span>(<span class="at">psill =</span> <span class="dv">1</span>, <span class="co"># create model</span></span>
<span id="cb6-3"><a href="introduction-to-kriging.html#cb6-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">model =</span> <span class="st">&quot;Sph&quot;</span>, <span class="co"># &quot;Sph&quot;, &quot;Exp&quot;, &quot;Gau&quot;, &quot;Mat&quot;, &quot;Pow&quot;</span></span>
<span id="cb6-4"><a href="introduction-to-kriging.html#cb6-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">range =</span> <span class="dv">900</span>, </span>
<span id="cb6-5"><a href="introduction-to-kriging.html#cb6-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">nugget =</span> <span class="dv">1</span>)</span>
<span id="cb6-6"><a href="introduction-to-kriging.html#cb6-6" aria-hidden="true" tabindex="-1"></a>lzn.fit <span class="ot">&lt;-</span> <span class="fu">fit.variogram</span>(lzn.vgm, lzn.model) <span class="co"># fit model</span></span>
<span id="cb6-7"><a href="introduction-to-kriging.html#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(lzn.vgm, lzn.fit)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
</div>
<div id="建立各種克里金模型" class="section level4 hasAnchor" number="1.3.0.2">
<h4><span class="header-section-number">1.3.0.2</span> 建立各種克里金模型<a href="introduction-to-kriging.html#建立各種克里金模型" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="introduction-to-kriging.html#cb7-1" aria-hidden="true" tabindex="-1"></a>OK <span class="ot">&lt;-</span> <span class="fu">krige</span>(<span class="fu">log</span>(zinc) <span class="sc">~</span> <span class="dv">1</span>, meuse, GridBAUs, <span class="at">model=</span>lzn.fit) <span class="co"># Ordinary kriging</span></span></code></pre></div>
<pre><code>## [using ordinary kriging]</code></pre>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="introduction-to-kriging.html#cb9-1" aria-hidden="true" tabindex="-1"></a>UK <span class="ot">&lt;-</span> <span class="fu">krige</span>(<span class="fu">log</span>(zinc) <span class="sc">~</span> x<span class="sc">+</span>y, meuse, GridBAUs, <span class="at">model =</span> lzn.fit) <span class="co"># Universal kriging</span></span></code></pre></div>
<pre><code>## [using universal kriging]</code></pre>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="introduction-to-kriging.html#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(var1.pred <span class="sc">~</span> x <span class="sc">+</span> y, UK) <span class="co"># Use Universal kriging to calaulate the coefficient</span></span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = var1.pred ~ x + y, data = UK)
## 
## Coefficients:
## (Intercept)            x            y  
##  -8.0324313   -0.0008891    0.0005250</code></pre>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="introduction-to-kriging.html#cb13-1" aria-hidden="true" tabindex="-1"></a>SK <span class="ot">&lt;-</span> <span class="fu">krige</span>(<span class="fu">log</span>(zinc)<span class="sc">~</span>x<span class="sc">+</span>y, meuse, GridBAUs, lzn.fit, </span>
<span id="cb13-2"><a href="introduction-to-kriging.html#cb13-2" aria-hidden="true" tabindex="-1"></a>            <span class="at">beta =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">8.0324313</span>, <span class="sc">-</span><span class="fl">0.0008891</span>, <span class="fl">0.0005250</span>)) <span class="co"># Simple kriging</span></span></code></pre></div>
<pre><code>## [using simple kriging]</code></pre>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="introduction-to-kriging.html#cb15-1" aria-hidden="true" tabindex="-1"></a>CK <span class="ot">&lt;-</span> <span class="fu">gstat</span>(<span class="cn">NULL</span>, <span class="st">&quot;logCd&quot;</span>, <span class="fu">log</span>(cadmium) <span class="sc">~</span> <span class="dv">1</span>, meuse)</span>
<span id="cb15-2"><a href="introduction-to-kriging.html#cb15-2" aria-hidden="true" tabindex="-1"></a>CK <span class="ot">&lt;-</span> <span class="fu">gstat</span>(CK, <span class="st">&quot;logCu&quot;</span>, <span class="fu">log</span>(copper) <span class="sc">~</span> <span class="dv">1</span>, meuse)</span>
<span id="cb15-3"><a href="introduction-to-kriging.html#cb15-3" aria-hidden="true" tabindex="-1"></a>CK <span class="ot">&lt;-</span> <span class="fu">gstat</span>(CK, <span class="st">&quot;logPb&quot;</span>, <span class="fu">log</span>(lead) <span class="sc">~</span> <span class="dv">1</span>,meuse)</span>
<span id="cb15-4"><a href="introduction-to-kriging.html#cb15-4" aria-hidden="true" tabindex="-1"></a>CK <span class="ot">&lt;-</span> <span class="fu">gstat</span>(CK, <span class="st">&quot;logZn&quot;</span>, <span class="fu">log</span>(zinc) <span class="sc">~</span> <span class="dv">1</span>,meuse)</span>
<span id="cb15-5"><a href="introduction-to-kriging.html#cb15-5" aria-hidden="true" tabindex="-1"></a>CK.vgm <span class="ot">&lt;-</span> <span class="fu">variogram</span>(CK)</span>
<span id="cb15-6"><a href="introduction-to-kriging.html#cb15-6" aria-hidden="true" tabindex="-1"></a>CK.model <span class="ot">&lt;-</span> <span class="fu">vgm</span>(<span class="at">psill =</span> <span class="dv">1</span>, <span class="at">model =</span> <span class="st">&quot;Sph&quot;</span>,</span>
<span id="cb15-7"><a href="introduction-to-kriging.html#cb15-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">range =</span> <span class="dv">800</span>, <span class="at">nugget =</span> <span class="dv">1</span>)</span>
<span id="cb15-8"><a href="introduction-to-kriging.html#cb15-8" aria-hidden="true" tabindex="-1"></a>CK.fit <span class="ot">&lt;-</span> <span class="fu">fit.lmc</span>(CK.vgm, CK, CK.model)</span>
<span id="cb15-9"><a href="introduction-to-kriging.html#cb15-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(CK.vgm, CK.fit)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="introduction-to-kriging.html#cb16-1" aria-hidden="true" tabindex="-1"></a>CK <span class="ot">&lt;-</span> <span class="fu">predict</span>(CK.fit, GridBAUs) <span class="co"># Ordinary CoKriging</span></span></code></pre></div>
<pre><code>## Linear Model of Coregionalization found. Good.
## [using ordinary cokriging]</code></pre>
<ol start="5" style="list-style-type: decimal">
<li>各種模型比較</li>
</ol>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="introduction-to-kriging.html#cb18-1" aria-hidden="true" tabindex="-1"></a>OK.plot <span class="ot">&lt;-</span> OK <span class="sc">%&gt;%</span> as.data.frame <span class="sc">%&gt;%</span></span>
<span id="cb18-2"><a href="introduction-to-kriging.html#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span> <span class="fu">aes</span>(x,y,<span class="at">fill =</span> var1.pred) <span class="sc">+</span> </span>
<span id="cb18-3"><a href="introduction-to-kriging.html#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>() <span class="sc">+</span> <span class="fu">coord_fixed</span>() <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&#39;Ordinary Kriging&#39;</span>) <span class="sc">+</span> </span>
<span id="cb18-4"><a href="introduction-to-kriging.html#cb18-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_distiller</span>(<span class="at">palette=</span><span class="st">&quot;Spectral&quot;</span>, <span class="at">name=</span><span class="st">&quot;pred.&quot;</span>)  <span class="sc">+</span> </span>
<span id="cb18-5"><a href="introduction-to-kriging.html#cb18-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data=</span><span class="fu">data.frame</span>(meuse), <span class="fu">aes</span>(x,y,<span class="at">fill=</span><span class="fu">log</span>(zinc)), <span class="at">colour=</span><span class="st">&quot;black&quot;</span>,</span>
<span id="cb18-6"><a href="introduction-to-kriging.html#cb18-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">pch=</span><span class="dv">21</span>, <span class="at">size=</span><span class="dv">3</span>) </span>
<span id="cb18-7"><a href="introduction-to-kriging.html#cb18-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-8"><a href="introduction-to-kriging.html#cb18-8" aria-hidden="true" tabindex="-1"></a>UK.plot <span class="ot">&lt;-</span> UK <span class="sc">%&gt;%</span> as.data.frame <span class="sc">%&gt;%</span></span>
<span id="cb18-9"><a href="introduction-to-kriging.html#cb18-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span> <span class="fu">aes</span>(x,y,<span class="at">fill =</span> var1.pred) <span class="sc">+</span> </span>
<span id="cb18-10"><a href="introduction-to-kriging.html#cb18-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>() <span class="sc">+</span> <span class="fu">coord_fixed</span>() <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&#39;Universal Kriging&#39;</span>) <span class="sc">+</span> </span>
<span id="cb18-11"><a href="introduction-to-kriging.html#cb18-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_distiller</span>(<span class="at">palette=</span><span class="st">&quot;Spectral&quot;</span>, <span class="at">name=</span><span class="st">&quot;pred.&quot;</span>)  <span class="sc">+</span> </span>
<span id="cb18-12"><a href="introduction-to-kriging.html#cb18-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data=</span><span class="fu">data.frame</span>(meuse), <span class="fu">aes</span>(x,y,<span class="at">fill=</span><span class="fu">log</span>(zinc)), <span class="at">colour=</span><span class="st">&quot;black&quot;</span>,</span>
<span id="cb18-13"><a href="introduction-to-kriging.html#cb18-13" aria-hidden="true" tabindex="-1"></a>             <span class="at">pch=</span><span class="dv">21</span>, <span class="at">size=</span><span class="dv">3</span>) </span>
<span id="cb18-14"><a href="introduction-to-kriging.html#cb18-14" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb18-15"><a href="introduction-to-kriging.html#cb18-15" aria-hidden="true" tabindex="-1"></a>SK.plot <span class="ot">&lt;-</span> SK <span class="sc">%&gt;%</span> as.data.frame <span class="sc">%&gt;%</span></span>
<span id="cb18-16"><a href="introduction-to-kriging.html#cb18-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span> <span class="fu">aes</span>(x,y,<span class="at">fill =</span> var1.pred) <span class="sc">+</span> </span>
<span id="cb18-17"><a href="introduction-to-kriging.html#cb18-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>() <span class="sc">+</span> <span class="fu">coord_fixed</span>() <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&#39;Simple Kriging&#39;</span>) <span class="sc">+</span> </span>
<span id="cb18-18"><a href="introduction-to-kriging.html#cb18-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_distiller</span>(<span class="at">palette=</span><span class="st">&quot;Spectral&quot;</span>, <span class="at">name=</span><span class="st">&quot;pred.&quot;</span>)  <span class="sc">+</span> </span>
<span id="cb18-19"><a href="introduction-to-kriging.html#cb18-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data=</span><span class="fu">data.frame</span>(meuse), <span class="fu">aes</span>(x,y,<span class="at">fill=</span><span class="fu">log</span>(zinc)), <span class="at">colour=</span><span class="st">&quot;black&quot;</span>,</span>
<span id="cb18-20"><a href="introduction-to-kriging.html#cb18-20" aria-hidden="true" tabindex="-1"></a>             <span class="at">pch=</span><span class="dv">21</span>, <span class="at">size=</span><span class="dv">3</span>) </span>
<span id="cb18-21"><a href="introduction-to-kriging.html#cb18-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-22"><a href="introduction-to-kriging.html#cb18-22" aria-hidden="true" tabindex="-1"></a>CK.plot <span class="ot">&lt;-</span> CK <span class="sc">%&gt;%</span> as.data.frame <span class="sc">%&gt;%</span></span>
<span id="cb18-23"><a href="introduction-to-kriging.html#cb18-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span> <span class="fu">aes</span>(x,y,<span class="at">fill =</span> logZn.pred) <span class="sc">+</span> </span>
<span id="cb18-24"><a href="introduction-to-kriging.html#cb18-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>() <span class="sc">+</span> <span class="fu">coord_fixed</span>() <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&#39;CoKriging&#39;</span>) <span class="sc">+</span> </span>
<span id="cb18-25"><a href="introduction-to-kriging.html#cb18-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_distiller</span>(<span class="at">palette=</span><span class="st">&quot;Spectral&quot;</span>, <span class="at">name=</span><span class="st">&quot;pred.&quot;</span>)  <span class="sc">+</span> </span>
<span id="cb18-26"><a href="introduction-to-kriging.html#cb18-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data=</span><span class="fu">data.frame</span>(meuse), <span class="fu">aes</span>(x,y,<span class="at">fill=</span><span class="fu">log</span>(zinc)), <span class="at">colour=</span><span class="st">&quot;black&quot;</span>,</span>
<span id="cb18-27"><a href="introduction-to-kriging.html#cb18-27" aria-hidden="true" tabindex="-1"></a>             <span class="at">pch=</span><span class="dv">21</span>, <span class="at">size=</span><span class="dv">3</span>)</span>
<span id="cb18-28"><a href="introduction-to-kriging.html#cb18-28" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb18-29"><a href="introduction-to-kriging.html#cb18-29" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(SK.plot, OK.plot, UK.plot, CK.plot, <span class="at">ncol =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<ol start="6" style="list-style-type: decimal">
<li>比較各種模型誤差</li>
</ol>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="introduction-to-kriging.html#cb19-1" aria-hidden="true" tabindex="-1"></a>OK.varplot <span class="ot">&lt;-</span> OK <span class="sc">%&gt;%</span> as.data.frame <span class="sc">%&gt;%</span></span>
<span id="cb19-2"><a href="introduction-to-kriging.html#cb19-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span> <span class="fu">aes</span>(x,y,<span class="at">fill =</span> var1.var) <span class="sc">+</span> </span>
<span id="cb19-3"><a href="introduction-to-kriging.html#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>() <span class="sc">+</span> <span class="fu">coord_fixed</span>() <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&#39;Ordinary Kriging&#39;</span>) <span class="sc">+</span> </span>
<span id="cb19-4"><a href="introduction-to-kriging.html#cb19-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_distiller</span>(<span class="at">palette=</span><span class="st">&quot;Spectral&quot;</span>, <span class="at">name=</span><span class="st">&quot;var.&quot;</span>)</span>
<span id="cb19-5"><a href="introduction-to-kriging.html#cb19-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-6"><a href="introduction-to-kriging.html#cb19-6" aria-hidden="true" tabindex="-1"></a>UK.varplot <span class="ot">&lt;-</span> UK <span class="sc">%&gt;%</span> as.data.frame <span class="sc">%&gt;%</span></span>
<span id="cb19-7"><a href="introduction-to-kriging.html#cb19-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span> <span class="fu">aes</span>(x,y,<span class="at">fill =</span> var1.var) <span class="sc">+</span> </span>
<span id="cb19-8"><a href="introduction-to-kriging.html#cb19-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>() <span class="sc">+</span> <span class="fu">coord_fixed</span>() <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&#39;Universal Kriging&#39;</span>) <span class="sc">+</span> </span>
<span id="cb19-9"><a href="introduction-to-kriging.html#cb19-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_distiller</span>(<span class="at">palette=</span><span class="st">&quot;Spectral&quot;</span>, <span class="at">name=</span><span class="st">&quot;var.&quot;</span>)</span>
<span id="cb19-10"><a href="introduction-to-kriging.html#cb19-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-11"><a href="introduction-to-kriging.html#cb19-11" aria-hidden="true" tabindex="-1"></a>SK.varplot <span class="ot">&lt;-</span> SK <span class="sc">%&gt;%</span> as.data.frame <span class="sc">%&gt;%</span></span>
<span id="cb19-12"><a href="introduction-to-kriging.html#cb19-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span> <span class="fu">aes</span>(x,y,<span class="at">fill =</span> var1.var) <span class="sc">+</span> </span>
<span id="cb19-13"><a href="introduction-to-kriging.html#cb19-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>() <span class="sc">+</span> <span class="fu">coord_fixed</span>() <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&#39;Simple Kriging&#39;</span>) <span class="sc">+</span> </span>
<span id="cb19-14"><a href="introduction-to-kriging.html#cb19-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_distiller</span>(<span class="at">palette=</span><span class="st">&quot;Spectral&quot;</span>, <span class="at">name=</span><span class="st">&quot;var.&quot;</span>)</span>
<span id="cb19-15"><a href="introduction-to-kriging.html#cb19-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-16"><a href="introduction-to-kriging.html#cb19-16" aria-hidden="true" tabindex="-1"></a>CK.varplot <span class="ot">&lt;-</span> CK <span class="sc">%&gt;%</span> as.data.frame <span class="sc">%&gt;%</span></span>
<span id="cb19-17"><a href="introduction-to-kriging.html#cb19-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span> <span class="fu">aes</span>(x,y,<span class="at">fill =</span> logZn.var) <span class="sc">+</span> </span>
<span id="cb19-18"><a href="introduction-to-kriging.html#cb19-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>() <span class="sc">+</span> <span class="fu">coord_fixed</span>() <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&#39;CoKriging&#39;</span>) <span class="sc">+</span> </span>
<span id="cb19-19"><a href="introduction-to-kriging.html#cb19-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_distiller</span>(<span class="at">palette=</span><span class="st">&quot;Spectral&quot;</span>, <span class="at">name=</span><span class="st">&quot;var.&quot;</span>)</span>
<span id="cb19-20"><a href="introduction-to-kriging.html#cb19-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb19-21"><a href="introduction-to-kriging.html#cb19-21" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(SK.varplot, OK.varplot, UK.varplot, CK.varplot, <span class="at">ncol =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<ol start="7" style="list-style-type: decimal">
<li>克里金模型交叉驗證</li>
</ol>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="introduction-to-kriging.html#cb20-1" aria-hidden="true" tabindex="-1"></a>OK.cv <span class="ot">&lt;-</span> <span class="fu">krige.cv</span>(<span class="fu">log</span>(zinc) <span class="sc">~</span> <span class="dv">1</span>, meuse, lzn.fit,</span>
<span id="cb20-2"><a href="introduction-to-kriging.html#cb20-2" aria-hidden="true" tabindex="-1"></a>               <span class="at">nfold =</span> <span class="dv">10</span>, <span class="at">verbose =</span> F)</span>
<span id="cb20-3"><a href="introduction-to-kriging.html#cb20-3" aria-hidden="true" tabindex="-1"></a>UK.cv <span class="ot">&lt;-</span> <span class="fu">krige.cv</span>(<span class="fu">log</span>(zinc) <span class="sc">~</span> x <span class="sc">+</span> y, meuse, lzn.fit,</span>
<span id="cb20-4"><a href="introduction-to-kriging.html#cb20-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">nfold =</span> <span class="dv">10</span>, <span class="at">verbose =</span> F)</span>
<span id="cb20-5"><a href="introduction-to-kriging.html#cb20-5" aria-hidden="true" tabindex="-1"></a>SK.cv <span class="ot">&lt;-</span> <span class="fu">krige.cv</span>(<span class="fu">log</span>(zinc) <span class="sc">~</span> x <span class="sc">+</span> y, meuse, lzn.fit,</span>
<span id="cb20-6"><a href="introduction-to-kriging.html#cb20-6" aria-hidden="true" tabindex="-1"></a>                  <span class="at">nfold =</span> <span class="dv">10</span>, <span class="at">verbose =</span> F, <span class="at">beta =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">8.0324313</span>, <span class="sc">-</span><span class="fl">0.0008891</span>, <span class="fl">0.0005250</span>))</span>
<span id="cb20-7"><a href="introduction-to-kriging.html#cb20-7" aria-hidden="true" tabindex="-1"></a>CK.cv <span class="ot">&lt;-</span> <span class="fu">gstat.cv</span>(CK.fit, <span class="at">verbose =</span> F, <span class="at">all.residuals =</span> T)</span></code></pre></div>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="index.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="linear-algebra.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/USERNAME/REPO/edit/BRANCH/08-Introduction-to-kriging.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/DongDong-Zoez/Data-Science-Blog/blob/master/08-Introduction-to-kriging.Rmd",
"text": null
},
"download": ["bookdownproj.pdf", "bookdownproj.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
